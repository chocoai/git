<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>查询结果统计表格</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
    <link rel="stylesheet" href="#(g_path)/js/miniui/miniui/themes/blue/skin.css" type="text/css"></link>
      <script src="#(g_path)/js/sys/common.js" type="text/javascript"></script>
	  


</head>

<style type="text/css">
	    body,html {
                width: 100%;
                height: 100%;
                padding: 0px;
                margin: 0px;
                overflow: hidden;
            }
            .lableright{
                width: 80px;
                text-align: right;
            }
		
	  </style>  
<body>

    
    <div>
        <div id="editForms" >
           <table>
                <tr>
                    <td style="width:80px;text-align: center">基准电压:</td>
		        <td >
		            <input id="dydjdm" name="dydjdm" class="mini-combobox" style="width:120px"  url="#(g_path)/biandianzhan1/jzdy_query" showNullItem="true"   textField="text" valueField="id"  />
		        	</td>
		        <td style="width:85px;text-align: center" >所属管理机构:</td>
		        <td >
		            <input  id="gddwbm" name="gddwbm" class="mini-combobox"  style="width:120px"  url="#(g_path)/biandianzhan1/ssgljg_query" showNullItem="true"  textField="text" valueField="id" />
		        </td>
		        <td style="width:80px;text-align: center">厂站类别:</td>
		        <td>
		            <input  id="bdzlxdm" name="bdzlxdm" class="mini-combobox"  style="width:120px" url="#(g_path)/biandianzhan1/czlb_query" showNullItem="true"  textField="text" valueField="id"  />
		        </td>
		         <td style="width:80px;text-align: center">运行状态:</td>
		        <td >
		            <input  id="bdzyxzt" name="bdzyxzt" class="mini-combobox"   style="width:120px"   url="#(g_path)/biandianzhan1/yxzt_query" showNullItem="true"  textField="text" valueField="id"  />
		        </td>
                
                    <td>
                         <a id="querys" class="mini-button" iconCls="icon-search" plain="true" onclick="onSearch();">查询</a>
                        <a class="mini-button" iconCls="icon-reload" plain="true" onclick="">重置</a>
                        <a class="mini-button" iconCls="icon-edit" plain="true" onclick="">新建</a>
                    </td>
                </tr>
                 </table>   
        
               <table>
                <tr>
                   <td style="width:80px;text-align: center">局方编号:</td>
		    <td>
		            <input  id="gddwbm" name="gddwbm" class="mini-textbox" style="width:120px" />
		    </td>
		    <td style="width:85px;text-align: center">厂站名称:</td>
		    <td>
		            <input id="bdzmc" name="bdzmc" class="mini-textbox"  style="width:120px" />
		    </td>
		    <td style="width:80px;text-align: center">主变台数:</td>
		    <td >
		            <input id="zbts" name=zbts"  class="mini-textbox"  style="width:120px"/>
		    </td>
		    <td style="width:80px;text-align: center">营销核对:</td>
		    <td>
		            <input id="" name=" " class="mini-combobox"  style="width:120px" url="#(g_path)/biandianzhan/yxhd_query" showNullItem="true" textField="text" valueField="id" />
		    </td>
                
                    <td>
                        <p class="mini-checkbox">精准查询</p>
                        <a class="mini-button" iconCls="icon-upload" plain="true" onclick="">导出</a>
                        <a class="mini-button" iconCls="icon-download" plain="true" onclick="">导入</a>
                    </td>
                </tr>
                 
            </table>   
        </div>
    </div>
    
    
    
    <div id="datagrid1" class="mini-datagrid" style="width:100%;height:100%;" 
        url="#(g_path)/biandianzhan1/list" idField="id" 
        allowResize="true" pageSize="20" 
        allowCellEdit="true" allowCellSelect="true" multiSelect="true" 
        editNextOnEnterKey="true"  editNextRowCell="true"
        
    >
        <div property="columns">
            <!-- <div type="indexcolumn" >序号</div> -->
            <div field="gddwbm" width="50" headerAlign="center" align="center" allowSort="false" renderer="onActionRenderer">局方编号</div>
            <div field="dydjdm_mc" width="50" headerAlign="center" align="center" allowSort="false" >基准电压</div> 
           	<div field="org_name" width="50" headerAlign="center" align="center" allowSort="false" >所属管理机构</div>
           	<div field="bdzmc" width="50" headerAlign="center" align="center" allowSort="false" >厂站名称</div> 
           	<div field="" width="50" headerAlign="center" align="center" allowSort="false" >所属发电集团</div>
           	<div field="bdzlxdm_mc" width="50" headerAlign="center" align="center" allowSort="false" >厂站类别</div>
           	<div field="bdzyxztdm_mc" width="50" headerAlign="center" align="center" allowSort="false" >运行状态</div>
           	<div field="gddylxdm_mc" width="50" headerAlign="center" align="center" allowSort="false" >能源类型</div>
           	<div field="dcxz" width="50" headerAlign="center" align="center" allowSort="false" >厂站性质</div>
           	<div field="ddgxdm" width="50" headerAlign="center" align="center" allowSort="false" >调度关系</div>
           	<div field="zjzrl" width="50" headerAlign="center" align="center" allowSort="false" >装机容量(KW)</div>
            </div>
          </div> 
    </div>
    <script type="text/javascript">
 	var winWidth = 925;
	var winHeight = 450;
	    mini.parse();
	    var grid = mini.get("datagrid1");
	     grid.load();
	    /*var sorter = new MultiSort(grid);
	   	sorter.sort([
	    	{ field: "id", dir: "asc" }
	  	]); */
	
	
		//查询条件同学在一个列表中，直接调用原本列表的方法即可。
	    function onSearch() {
	    	var form = new mini.Form("#editForms");
	        var param = form.getData(true, false);
	        grid.load(param);
	    }
	    
	    
	    function querys(){
    	var url = "#(g_path)/biandianzhan1/list";
			var form = new mini.Form("#editForms");
			form.validate();
        	if (form.isValid() == false) return;
       	 	var param = form.getData(true, false);
			getJson(url,param,true,function(re){
// 				if(re != null){
// 					CloseWindow(re);
// 					grid.load(param);
// 				}
			});
  	  }
    
    
    
		
		
		
		
		
		
		function onDel(){
			var rows = grid.getSelecteds();
			
			if(rows.length < 1){
				MsgBox.showWarningTips("请先勾选删除数据！");
				return;
			}
			
			MsgBox.confirm("确定要删除吗？", function(b){
				if(b){
					var ids = "";
					for(var i=0; i < rows.length; i++){
						if(ids)
							ids += ",";
						ids += rows[i][""];//字段
					}
					var url = "";
					var param = 
					getJson(url,{ids : ids},true,function(re){
						if(re.isOk){
							onSearch();
						}
					});
				}
			})
		}
		
		function onEdit(){
			var row = grid.getSelected();
			if(row){
				var url = "" + row[""];
				var title = "编辑";
				MsgBox.openWin(url, title,  winWidth, winHeight, function(win){
				}, function(action,win){
					if(action == "ok"){
						onSearch();
					}
				});
			}
			else{
				MsgBox.showWarningTips("请先选择编辑数据！");
			}
		}
		
		function onExport(){
			var columns = grid.columns;
			console.log(columns);
			console.log(columns[0]);
	        function getColumns(columns) {
	            var cols = [];
	            for (var i = 0; i < columns.length; i++) {
	                var column = columns[i];
					if(column.type=="checkcolumn" || column.type=="indexcolumn")
						continue;
	                var col = { header: column.header, field: column.field, type: column.type };
	                if (column.columns) {
	                    col.columns = getColumns(column.columns);
	                }
	                cols.push(col);
	
	            }
	            return cols;
	        } 
	        var columns = getColumns(columns);
			var form = new mini.Form("#searchForm");
	        var param = form.getData(true, false);
	        
			var uploadFormJq = $("#excelExportForm");
			if (jQuery("[name=upload_iframe]").size() < 1){
				uploadFormJq = $('<form id="excelExportForm" name="excelExportForm" target="_blank" method="post" action="/comm/busi_method/exportdata"><input name="columns" type="hidden"/><input name="data" type="hidden"/></form>');
		        jQuery(document.body).append(uploadFormJq);
		    }
		    
		    uploadFormJq.find("[name=columns]").val(mini.encode(columns));
		    uploadFormJq.find("[name=data]").val(mini.encode(param));
	        uploadFormJq.get(0).submit();
		}
    </script>
</body>
</html>